<!DOCTYPE html>
<html>
<head>
  <title>Lightweight Wordpress on Slicehost | Boris Smus</title>

  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0' />

  <meta name="description" content="My experiences moving from the WebFaction shared host to the Slicehost VPS." />
  <meta name="author" content="Boris Smus" />
  <link rel="canonical" href="https://smus.com/lightweight-wordpress-on-slicehost/" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lightweight Wordpress on Slicehost" />
  <meta name="twitter:description" content="My experiences moving from the WebFaction shared host to the Slicehost VPS." />

  <!-- Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://smus.com/lightweight-wordpress-on-slicehost/" />
  <meta property="og:title" content="Lightweight Wordpress on Slicehost" />
  <meta property="og:description" content="My experiences moving from the WebFaction shared host to the Slicehost VPS." />

  <!-- Mastodon -->
  <link rel="me" href="https://mastodon.social/@borismus">

  <!-- Coil monetization experiment: https://coil.com/settings/monetize -->
  <meta name="monetization" content="$ilp.uphold.com/4Fnyw8KLaPZG">

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/icons/favicon-16x16.png">
  <link rel="manifest" href="/static/icons/site.webmanifest">

  <!-- Styles -->
  <link
  href='//fonts.googleapis.com/css?family=Roboto+Condensed:300|Open+Sans+Condensed:700|Source+Serif+Pro:400,700|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel='stylesheet' href='/static/css/style.css'>
  <link rel='stylesheet' href='/static/css/syntax-highlight.css'>

  <!-- Feed -->
  <link href="https://smus.com/atom.xml" rel="alternate" title="Boris Smus" type="application/atom+xml"/>
</head>
<body>
<header>
  <div id='title'>
    <h1><a href='/'>Boris Smus</a></h1>
    <h2>interaction engineering</h2>
  </div>
  <nav role='navigation'>
    <a href='/about/' >About</a>
    <a href='/blog/' >Blog</a>
    <a href='/projects/' >Projects</a>
  </nav>
</header>

<section id='main'>
  <article>
    <a href='/lightweight-wordpress-on-slicehost'><h1 class='title'>Lightweight Wordpress on Slicehost</h1></a>
    <div class='body'>
      <p>I recently switched from shared hosting to a VPS, expecting to get an
immediate and automatic performance boost. I was overly optimistic and
ran into memory trouble right away. After endlessly struggling with
Apache and mod_php configuration, I was ready to give up. Then on a
whim, I switched to nginx/fastcgi to see the average response time drop
from 1500ms to 300ms: </p>
<p><img alt="image" src="performance.png" /> </p>
<p><a href="http://www.webfaction.com">WebFaction</a> is a great shared hosting environment, providing tons of
functionality and impeccable customer support. However, shared hosting
means that multiple users share resources on a single physical machine,
resulting in wildly fluctuating <a href="http://www.pingdom.com">site performance and uptime</a> at the
whim of other clients. Also, I prefer to do system administration from
the command line, but WebFaction provides a powerful but clunky
web-based administrative interface. All in all, despite my respect for
WebFaction, I said goodbye and switched to <a href="http://www.slicehost.com">Slicehost</a>. </p>
<p>I ordered my shiny new slice and plunged into configuration. I migrated
wordpress databases and set up Apache with mod_php. Everything seemed
to work reasonably well until Apache ran for a few hours and began
consuming my memory allowance. The slice started thrashing and
performance fell to a crawl.  I found the culprit to be in my
mpm_prefork_module MaxClients and MaxRequestsPerChild configuration,
but even after tweaking those, my slice was hitting the wall pretty
quickly. I nearly returned to cushy WebFaction, where I had marginal
performance without the headache, but decided to experiment more. </p>
<p>Nginx is a minimalist HTTP server written by <a href="http://sysoev.ru/en/">Igor Sysoev</a> for
<a href="http://www.rambler.ru/">Rambler</a>. It's now being used by <a href="http://www.wordpress.com">Wordpress</a> and other high profile
sites. Seeking help from the internet, I eventually came across Thomasz
Sterna's <a href="http://tomasz.sterna.tv/2009/04/php-fastcgi-with-nginx-on-ubuntu/">php-fastcgi init script</a> and adapted it for my slice,
using</p>
<pre><code>PHP_FCGI_CHILDREN=5
PHP_FCGI_MAX_REQUESTS=100
</code></pre>
<p>for the low-memory environment. In addition, I installed the 
<a href="http://wordpress.org/extend/plugins/wp-super-cache/">WP Super Cache</a> plugin.</p>
<p>For my <a href="http://www.guitarunleashed.com">django site</a>, I wrote an init script for 
launching the django fcgi server via django's manage.py. Here's the
important part:</p>
<pre><code>MAXCHILDREN=5
MAXSPARE=5
MINSPARE=2 
# ... 
start-stop-daemon --quiet --start \
  --pidfile $PIDFILE --chuid "$USER" \
  --exec /usr/bin/env -- python $SITEPATH/$SITENAME/manage.py runfcgi \
  --settings=settings \
  host=$HOST port=$PORT pidfile=$PIDFILE \
  maxchildren=$MAXCHILDREN maxspare=$MAXSPARE minspare=$MINSPARE
</code></pre>
<p>I'm happy with the performance both for django and php-powered sites.
However, I'm just guessing when it comes to values of <code>MAXCHILDREN</code>,
<code>MAXSPARE</code> and <code>MINSPARE</code>, <code>PHP_FCGI_CHILDREN</code> and
<code>PHP_FCGI_MAX_REQUESTS</code>.</p>
<p>Do you have insight on how to tweak these parameters? Is your VPS
hosting configuration better?</p>
    </div>
    <div class='subfooter'>
      <div class='tombstone'>▪</div>
      <time class='published'>February 26, 2010</time>
    </div>
  </article>
</section>


<footer>
  <div>
    © Copyright 2005–2025 Boris Smus.
  </div>
  <nav role="footer">
    <a href='https://smus.com/atom.xml'>RSS</a>
    <a style="display: none" rel="me" href="https://mastodon.social/@borismus">Mastodon</a>
  </nav>
</footer>

<!-- Misc scripts: syntax highlighting, analytics, stats. -->
<script src="/static/js/highlight.pack.js"></script>
<!-- Syntax highlighting for code. -->
<script>
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
</script>
<!-- Lightning builder error check. -->
<script src="/lightning_error.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-38Y45XD5VQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-38Y45XD5VQ');
</script>


</body>
</html>