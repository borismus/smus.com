<!DOCTYPE html>
<html>
<head>
  <title>Prototyping with Wii remotes in python | Boris Smus</title>

  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0' />

  <meta name="description" content="A how-to about getting access to a wii remote using Python." />
  <meta name="author" content="Boris Smus" />
  <link rel="canonical" href="https://smus.com/prototyping-wii-remote-python" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Prototyping with Wii remotes in python" />
  <meta name="twitter:description" content="A how-to about getting access to a wii remote using Python." />

  <!-- Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://smus.com/prototyping-wii-remote-python" />
  <meta property="og:title" content="Prototyping with Wii remotes in python" />
  <meta property="og:description" content="A how-to about getting access to a wii remote using Python." />

  <!-- Coil monetization experiment: https://coil.com/settings/monetize -->
  <meta name="monetization" content="$ilp.uphold.com/4Fnyw8KLaPZG">

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/icons/favicon-16x16.png">
  <link rel="manifest" href="/static/icons/site.webmanifest">

  <!-- Styles -->
  <link
  href='//fonts.googleapis.com/css?family=Roboto+Condensed:300|Open+Sans+Condensed:700|Source+Serif+Pro:400,700|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel='stylesheet' href='/static/css/style.css'>
  <link rel='stylesheet' href='/static/css/syntax-highlight.css'>

  <!-- Feed -->
  <link href="https://smus.com/atom.xml" rel="alternate" title="Boris Smus" type="application/atom+xml"/>
</head>
<body>
<header>
  <div id='title'>
    <h1><a href='/'>Boris Smus</a></h1>
    <h2>interaction engineering</h2>
  </div>
  <nav role='navigation'>
    <a href='/about/' >About</a>
    <a href='/blog/' >Blog</a>
    <a href='/clippings/' >Clippings</a>
  </nav>
</header>

<section id='main'>
  <article>
    <a href='/prototyping-wii-remote-python'><h1 class='title'>Prototyping with Wii remotes in python</h1></a>
    <div class='body'>
      <p>I've been working on a couple of researchy projects involving gait
recognition and running foot strike analysis. For my proof of concept, I
turned to the wiimote, everyone's favorite physical interaction
prototyping input device. Wiimotes are portable and rugged, and thus
well suited to high-intensity activities like running. They attach
easily to legs with a physio band, although the elastic tension tends to
cut off circulation. No big deal, though... it's For Science! </p>

<p>This article is not about attaching Wiis to legs (more on that at a
later date!), but about communicating with the Wii remote using python.
I started out by writing a Cocoa application to harvest accelerometer
data using the WiiRemote framework provided by the <a href="http://darwiin-remote.sourceforge.net/">DarwiinRemote</a>
project.  After some objective-c iterations of my initial gait
recognizer algorithm, I decided to port to python, an environment better
suited for light prototyping. There's a few packages explicitly
developed to integrate with the wiimote. <a href="http://stackoverflow.com/questions/481943/python-with-wiimote-using-pywiiuse-module">Pywiiuse</a> provides a
lightweight wrapper around the <a href="http://www.wiiuse.net/">wiiuse</a> library and does not work on
OS X. An alternative, <a href="http://code.google.com/p/pywiimote/">pywiimote</a> claims to be multiplatform but
pointedly isn't. Here's the start of their code: </p>

<pre><code>from ctypes import *
kernel = windll.kernel32
</code></pre>

<p>Having found no existing wiimote-specific python libraries that would
work on my platform, I had no choice but to dig a little into the
bluetooth-based protocol that the wiimote uses. I found all the details
in all their gory glory on the <a href="http://wiibrew.org/wiki/Wiimote#Accelerometer">wiibrew wiki</a>. The communication
protocol involves two open L2CAP sockets between the host and wiimote:
one for reading and one for writing. After an initialization string is
sent over the write socket, the wiimote springs into life and sends a
stream of data on the read socket. In this data are accelerometer values
and button presses. Here's a simple python snippet using the
<a href="http://lightblue.sourceforge.net/">lightblue</a> library:</p>

<pre><code>import sys, lightblue, hexbyte

WIIMOTE_DEVICE_NAME = 'Nintendo RVL-CNT-01'

# auto-discover nearby bluetooth devices
devs = lightblue.finddevices(getnames=True, length=5)
# find the one with the correct name
wiimote = [d for d in devs if d[1] == WIIMOTE_DEVICE_NAME] and d[0] or None
if not wiimote:
    print "No wiimotes found!"
    sys.exit(1)

# create a socket for writing control data
write_socket = lightblue.socket(lightblue.L2CAP)
write_socket.connect((wiimote, 0x11))

# create a socket for reading accelerometer data
read_socket = lightblue.socket(lightblue.L2CAP)
read_socket.connect((wiimote, 0x13))

# initialize the socket to the right mode
write_socket.send(hexbyte.HexToByte('52 12 00 33'))

# start reading data from it
while 1:
    byte = read_socket.recv(256 * 7)
    data = hexbyte.ByteToHex(byte)
    # do something interesting with the data
    print data
</code></pre>

<p>You'll need <a href="https://github.com/borismus/Running-Gestures/blob/master/hexbyte.py">hexbyte.py</a> to run the above snippet. I hope
you (the wii remote wielding python fan) find this snippet useful. As a
side note, if you've figured how to pair a wiimote with an android phone
and released the code into the public domain, please let me know. Since
Android 2.2 still doesn't ship with L2CAP APIs, I hit the wall.</p>

    </div>
    <div class='subfooter'>
      <div class='tombstone'>▪</div>
      <time class='published'>May 28, 2010</time>
    </div>
  </article>
</section>


<footer>
  <div>
    © Copyright 2005–2022 Boris Smus.
  </div>
  <nav role="footer">
    <a href='https://smus.com/atom.xml'>RSS</a>
  </nav>
</footer>

<!-- Misc scripts: syntax highlighting, analytics, stats. -->
<script src="/static/js/highlight.pack.js"></script>
<script>
  // Syntax highlighting for code.
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
</script>
<script>
  // Google Analytics.
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-17930798-22', 'smus.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>
<script src="/lightning_error.js"></script>

</body>
</html>