<!DOCTYPE html>
<html>
<head>
  <title>Multi-touch for your desktop browser | Boris Smus</title>

  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0' />

  <meta name="description" content="Prototyping multi-touch applications? Simulate spec-compatible touch events without a mobile device." />
  <meta name="author" content="Boris Smus" />
  <link rel="canonical" href="https://smus.com/multi-touch-browser-patch/" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Multi-touch for your desktop browser" />
  <meta name="twitter:description" content="Prototyping multi-touch applications? Simulate spec-compatible touch events without a mobile device." />

  <!-- Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://smus.com/multi-touch-browser-patch/" />
  <meta property="og:title" content="Multi-touch for your desktop browser" />
  <meta property="og:description" content="Prototyping multi-touch applications? Simulate spec-compatible touch events without a mobile device." />

  <!-- Mastodon -->
  <link rel="me" href="https://mastodon.social/@borismus">

  <!-- Coil monetization experiment: https://coil.com/settings/monetize -->
  <meta name="monetization" content="$ilp.uphold.com/4Fnyw8KLaPZG">

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/icons/favicon-16x16.png">
  <link rel="manifest" href="/static/icons/site.webmanifest">

  <!-- Styles -->
  <link
  href='//fonts.googleapis.com/css?family=Roboto+Condensed:300|Open+Sans+Condensed:700|Source+Serif+Pro:400,700|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel='stylesheet' href='/static/css/style.css'>
  <link rel='stylesheet' href='/static/css/syntax-highlight.css'>

  <!-- Feed -->
  <link href="https://smus.com/atom.xml" rel="alternate" title="Boris Smus" type="application/atom+xml"/>
</head>
<body>
<header>
  <div id='title'>
    <h1><a href='/'>Boris Smus</a></h1>
    <h2>interaction engineering</h2>
  </div>
  <nav role='navigation'>
    <a href='/about/' >About</a>
    <a href='/blog/' >Blog</a>
    <a href='/projects/' >Projects</a>
  </nav>
</header>

<section id='main'>
  <article>
    <a href='/multi-touch-browser-patch'><h1 class='title'>Multi-touch for your desktop browser</h1></a>
    <div class='body'>
      <p>In mobile development, it's often easier to start prototyping on the desktop
and then tackle the mobile-specific parts on the devices you intend to support.
Multi-touch is one of those features that's difficult to test on the desktop, since
most desktops didn't have multi-touch hardware, and thus desktop browsers don't
have touch event support. Things are different today (you hear every mother say). 
Most new Macs, for example, ship with multi-touch capable input of some sort.
Unfortunately the browsers haven't really caught up yet.</p>

<p>Enter Fajran Iman Rusadi, who released a <a href="https://github.com/fajran/npTuioClient">npTuioClient</a> NPAPI plugin with a
JavaScript wrapper. Unfortunately this library provides a non-standard API to
multi-touch, which is not ideal for developers that want to write their
multi-touch application on desktop and then run the same code on their mobile
devices without modifications.</p>

<h2>Browser Patches</h2>

<p>As HTML5 grows up, browser vendors struggle to stay current up with the growing
variety of specifications. The result is <a href="http://caniuse.com/">uneven feature support</a> across
browsers and a complex problem for web developers.</p>

<p>The web development community has rallied around <strong>shims</strong> and <strong>polyfills</strong>
for the solution. These are bizarre terms that I find confusing and so will
defer to <a href="http://remysharp.com/2010/10/08/what-is-a-polyfill/">Remy Sharp to define</a>. The basic idea of both is to fill in
functionality that's missing in the browser implementation.</p>

<p>Since we now have a well established <a href="https://dvcs.w3.org/hg/webevents/raw-file/tip/touchevents.html">touch events specification</a> working
group at the W3C, I wrote <a href="https://github.com/borismus/MagicTouch">MagicTouch.js</a>, a multi-touch polyfill thatlets
you, the developer, write the same code, test it on your desktop browser and
then, run it on your real device. Totally tubular!</p>

<p>MagicTouch.js still relies on the npTuioClient plugin, it just creates
spec-compatible touch events. Incidentally, here's how you can trigger custom
DOM events:</p>

<pre><code>var event = document.createEvent('CustomEvent');
// Initialize the event, make it bubble up and possible to cancel
event.initEvent('touchstart', true, true);
// Assign properties to the event
event.touches = touchArray;
...
// Get the element associated with the event
var element = document.elementFromPoint(...);
// Assign the element
event.target = element;
// Finally, dispatch the event
element.dispatchEvent(event);
</code></pre>

<p>Note that this approach to create custom DOM events is not cross-browser
compatible. I only tested in Chrome.</p>

<h2>Installation</h2>

<p>Here how to get multi-touch web events working in Chrome for Mac:</p>

<ol>
<li>Download and install the <a href="https://github.com/fajran/npTuioClient#readme">npTuioClient NPAPI plugin</a>
into <code>~/Library/Internet Plug-Ins/</code>.</li>
<li>Download the <a href="https://github.com/fajran/tongseng/downloads">TongSeng TUIO tracker</a> for Mac’s MagicPad and start the
server</li>
<li>Download <a href="https://github.com/borismus/MagicTouch">MagicTouch.js</a> and include both the script and the plugin in your
app.</li>
</ol>

<p>The code for this is as follows:</p>

<pre><code>&lt;head&gt;
  ...
  &lt;script src="/path/to/magictouch.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  ...
  &lt;object id="tuio" type="application/x-tuio" style="width:0; height:0;"&gt;
    TUIO Plugin failed to load
  &lt;/object&gt;
&lt;/body&gt;
</code></pre>

<p>...and you're off to the races! Your multi-touch code will now work. Try out
this <a href="https://github.com/borismus/MagicTouch/blob/master/samples/tracker.html">finger tracking demo</a> on either your multi-touch mobile device or your
newly patched desktop browser.</p>

<h2>Future Steps</h2>

<p>As you saw, MagicTouch.js takes some effort to set up initially, requires
you to use an <code>&lt;object&gt;</code> in the HTML, and also needs you to run a separate
process for intercepting touch events. While we can't quite get away without
having to run another process, we can eliminate the NPAPI plugin by using the
<a href="http://dev.w3.org/html5/websockets/">WebSocket API</a> to communicate to that process.</p>

<p>If you're interested in multi-touch mobile web development, check out this
<a href="http://www.html5rocks.com/mobile/touch.html">article on html5rocks.com</a>.</p>

    </div>
    <div class='subfooter'>
      <div class='tombstone'>▪</div>
      <time class='published'>May 2, 2011</time>
    </div>
  </article>
</section>


<footer>
  <div>
    © Copyright 2005–2024 Boris Smus.
  </div>
  <nav role="footer">
    <a href='https://smus.com/atom.xml'>RSS</a>
    <a style="display: none" rel="me" href="https://mastodon.social/@borismus">Mastodon</a>
  </nav>
</footer>

<!-- Misc scripts: syntax highlighting, analytics, stats. -->
<script src="/static/js/highlight.pack.js"></script>
<!-- Syntax highlighting for code. -->
<script>
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
</script>
<!-- Lightning builder error check. -->
<script src="/lightning_error.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-38Y45XD5VQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-38Y45XD5VQ');
</script>


</body>
</html>