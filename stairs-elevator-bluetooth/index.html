<!DOCTYPE html>
<html>
<head>
  <title>Stairs or elevator? Use bluetooth! | Boris Smus</title>

  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0' />

  <meta name="description" content="An exploration into using Bluetooth Sensor Networks for tracking patterns in behavior." />
  <meta name="author" content="Boris Smus" />
  <link rel="canonical" href="https://smus.com/stairs-elevator-bluetooth/" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Stairs or elevator? Use bluetooth!" />
  <meta name="twitter:description" content="An exploration into using Bluetooth Sensor Networks for tracking patterns in behavior." />

  <!-- Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://smus.com/stairs-elevator-bluetooth/" />
  <meta property="og:title" content="Stairs or elevator? Use bluetooth!" />
  <meta property="og:description" content="An exploration into using Bluetooth Sensor Networks for tracking patterns in behavior." />

  <!-- Mastodon -->
  <link rel="me" href="https://mastodon.social/@borismus">

  <!-- Coil monetization experiment: https://coil.com/settings/monetize -->
  <meta name="monetization" content="$ilp.uphold.com/4Fnyw8KLaPZG">

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/icons/favicon-16x16.png">
  <link rel="manifest" href="/static/icons/site.webmanifest">

  <!-- Styles -->
  <link
  href='//fonts.googleapis.com/css?family=Roboto+Condensed:300|Open+Sans+Condensed:700|Source+Serif+Pro:400,700|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel='stylesheet' href='/static/css/style.css'>
  <link rel='stylesheet' href='/static/css/syntax-highlight.css'>

  <!-- Feed -->
  <link href="https://smus.com/atom.xml" rel="alternate" title="Boris Smus" type="application/atom+xml"/>
</head>
<body>
<header>
  <div id='title'>
    <h1><a href='/'>Boris Smus</a></h1>
    <h2>interaction engineering</h2>
  </div>
  <nav role='navigation'>
    <a href='/about/' >About</a>
    <a href='/blog/' >Blog</a>
    <a href='/projects/' >Projects</a>
  </nav>
</header>

<section id='main'>
  <article>
    <a href='/stairs-elevator-bluetooth'><h1 class='title'>Stairs or elevator? Use bluetooth!</h1></a>
    <div class='body'>
      <p>Most people carry mobile phones, and many of those phones have
integrated bluetooth functionality. Some of these phones are in
discoverable mode, making them detectable by other bluetooth devices
(Note: many new phones disable discoverable mode on a timer). By
building and deploying such scanners in a bluetooth sensor network, we
can collect a lot of interesting information about people's behavior in
public places. This post is about a minimal compelling application of
this technology.</p>
<p>Unfortunately we had just 3 makeshift internet-enabled bluetooth sensor
nodes at our disposal. Under this constraint, we brainstormed several
interesting scenarios where a bluetooth sensor network can be used to
collect data, for example:</p>
<ul>
<li>People's movement patterns in a bar district</li>
<li>Tourists following informational signs to points of interest</li>
<li>Passengers riding a public bus system</li>
<li>Travel between floors in a building</li>
</ul>
<p>We decided to study patterns of travel (ie. climbing stairs vs. taking
the elevator) between two floors of a university building. We installed
three sensors: two on separate floors, and the third on the stairwell
connecting them (blue circles represent bluetooth scanner nodes in the
bluetooth sensor network).</p>
<p><img alt="image" src="problem.png" /> </p>
<p>This is a specific example of a more general point-to-point problem with
two possible paths. From this simple setup, It's possible to compute
whenever a trip was made from floor A to floor B, and whether or not the
traveler took the stairs or the elevator. Suppose that there was a trip
from A to B. If the trip was also made through C, it must have been made
via stairs, otherwise, it must have been made via elevator. Based on
this basic data, we can infer a number of features, some of which are:</p>
<ul>
<li>Popularity of each route (ex. stairs more popular in the morning)</li>
<li>Habit (ex. people that take the elevator always take the elevator)</li>
<li>Temporal patterns (ex. some people consistently take the elevator in
    the morning)</li>
<li>Duration of trips (ex. stairs down is faster, elevator up is faster)</li>
<li>Waiting time at each terminal (ex. waiting times higher for
    elevator)</li>
<li>Direction preferences (ex. many people prefer to take elevator up,
    stairs down)</li>
</ul>
<p>Unfortunately this project finished before any data was actually
collected! Luckily, the implementation is ready for use if you want to
take over! The following describes a simple implementation using EeePCs
or MacMinis:</p>
<h2>Implementing the Sensor Network</h2>
<p>The sensor network necessary for the inter-floor experiment consists of
several components:</p>
<p><img alt="image" src="architecture.png" /> </p>
<p>Each scanner is a computer with a bluetooth modem and a wireless
connection. We used two Mac Minis running OS X and one ASUS EeePC
running Linux. Every computer executed a <a href="/stairs-elevator-bluetooth/bluetooth_scanner.py">bluetooth scanner program</a>,
which scanned for bluetooth devices in the vicinity every 10 seconds,
and updated its list of nearby device IDs. Whenever the list of nearby
devices changed, it reported an ENTER or EXIT notification to the
central server via an HTTP POST. </p>
<p>The central server runs a MySQL database to store all notifications from
the scanners. Periodically, this <a href="/stairs-elevator-bluetooth/trip_analyzer.py">analyzer program</a> crawls the
database to extract trips from the data (ie. a device EXITs at one
sensor and subsequently ENTERs at another one). It also discerns between
trips taken by stairs and by elevator. Once trips are extracted, they
are appended to a Google Spreadsheet. This happens in "delayed
realtime", since a trip can only be inferred once the start and endpoint
are known.</p>
<p>The final component is a custom visualization written using <a href="http://raphaeljs.com/">Raphael</a>
and the <a href="http://code.google.com/apis/charttools/index.html">Google Visualization</a> framework. This JavaScript program
polls the spreadsheet every 10 seconds to see if any new trips were
added. If new trips were found, the visualization would update itself,
representing each trip as a circle moving from one terminal to another
along the stairs or elevator path. In addition, this visualization
stores a frequency chart over time to show how popular each of the
possible paths are.</p>
<p>For more information on related projects, check out <a href="http://dme.uma.pt/people/faculty/vassilis.kostakos/">Vassilis' work</a>
at UMa.</p>
    </div>
    <div class='subfooter'>
      <div class='tombstone'>▪</div>
      <time class='published'>September 30, 2010</time>
    </div>
  </article>
</section>


<footer>
  <div>
    © Copyright 2005–2025 Boris Smus.
  </div>
  <nav role="footer">
    <a href='https://smus.com/atom.xml'>RSS</a>
    <a style="display: none" rel="me" href="https://mastodon.social/@borismus">Mastodon</a>
  </nav>
</footer>

<!-- Misc scripts: syntax highlighting, analytics, stats. -->
<script src="/static/js/highlight.pack.js"></script>
<!-- Syntax highlighting for code. -->
<script>
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
</script>
<!-- Lightning builder error check. -->
<script src="/lightning_error.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-38Y45XD5VQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-38Y45XD5VQ');
</script>


</body>
</html>