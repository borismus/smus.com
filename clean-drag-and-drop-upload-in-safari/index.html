<!DOCTYPE html>
<html>
<head>
  <title>Clean drag and drop upload in Safari | Boris Smus</title>

  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0' />

  <meta name="description" content="A how-to about implementing file drag and drop from the desktop into Safari, and presenting the user with a nice UI." />
  <meta name="author" content="Boris Smus" />
  <link rel="canonical" href="https://smus.com/clean-drag-and-drop-upload-in-safari/" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Clean drag and drop upload in Safari" />
  <meta name="twitter:description" content="A how-to about implementing file drag and drop from the desktop into Safari, and presenting the user with a nice UI." />

  <!-- Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://smus.com/clean-drag-and-drop-upload-in-safari/" />
  <meta property="og:title" content="Clean drag and drop upload in Safari" />
  <meta property="og:description" content="A how-to about implementing file drag and drop from the desktop into Safari, and presenting the user with a nice UI." />

  <!-- Mastodon -->
  <link rel="me" href="https://mastodon.social/@borismus">

  <!-- Coil monetization experiment: https://coil.com/settings/monetize -->
  <meta name="monetization" content="$ilp.uphold.com/4Fnyw8KLaPZG">

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/icons/favicon-16x16.png">
  <link rel="manifest" href="/static/icons/site.webmanifest">

  <!-- Styles -->
  <link
  href='//fonts.googleapis.com/css?family=Roboto+Condensed:300|Open+Sans+Condensed:700|Source+Serif+Pro:400,700|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel='stylesheet' href='/static/css/style.css'>
  <link rel='stylesheet' href='/static/css/syntax-highlight.css'>

  <!-- Feed -->
  <link href="https://smus.com/atom.xml" rel="alternate" title="Boris Smus" type="application/atom+xml"/>
</head>
<body>
<header>
  <div id='title'>
    <h1><a href='/'>Boris Smus</a></h1>
    <h2>interaction engineering</h2>
  </div>
  <nav role='navigation'>
    <a href='/about/' >About</a>
    <a href='/blog/' >Blog</a>
    <a href='/projects/' >Projects</a>
  </nav>
</header>

<section id='main'>
  <article>
    <a href='/clean-drag-and-drop-upload-in-safari'><h1 class='title'>Clean drag and drop upload in Safari</h1></a>
    <div class='body'>
      <p>Somehow I often find myself arguing in defense of the web browser as a
viable platform for developing rich applications. In many such
discussions, the issue of interoperability with the desktop arises.
Someone will astutely observe that they <strong>can't even drag and drop</strong>
from their OS file manager into their browser, and all hell will break
loose. </p>
<p>Happily, this is changing! Since version 3, Safari on Mac OS X
has had support for <a href="http://www.jakeri.net/2008/04/drag-and-drop-into-file-upload-in-safari/">dragging and dropping files</a> from the finder into
file input boxes. In various kludgy ways, <a href="https://addons.mozilla.org/en-US/firefox/addon/2190">Firefox</a> and <a href="http://www.download.com/HTTP-File-Upload-ActiveX-Control/3000-2206_4-10451672.html">IE</a> are now
following suite. </p>
<p>Unfortunately, even in Safari, the default look of the
<code>&lt;input type="file"&gt;</code> box is quite ugly and the element itself is
<a href="http://www.quirksmode.org/dom/inputfile.html">difficult to style</a>. In addition, clicking anywhere in the file input
element causes the default open file dialog to appear. I wanted to
provide drag-and-drop uploading without ugly boxes or browser dialogs.
The solution I came up with involves hiding the file upload box entirely
by setting its opacity to 0, and then preventing the default action on
click via <code>event.preventDefault()</code>. Here's a sample of what I mean, with
the entire browser window <a href="/clean-drag-and-drop-upload-in-safari/drag-drop-upload.html">converted into a drag area</a>. </p>
<p>Note that the drag area must be the first DOM element to receive the drop event
for this approach to work. Unfortunately I ran into a bug where the file dialog
refuses to bubble click events to other elements below it. This is baffling to
me, since <code>event.preventDefault()</code> should not stop event propagation, but only
prevent the default browser handler from being called. You can see what I mean
by trying to click the link in the <a href="/clean-drag-and-drop-upload-in-safari/drag-drop-upload.html">sample HTML</a>
file. If this is not a bug, and someone has an answer, I would really
appreciate it.</p>
<p>Note also that there are <a href="http://www.radinks.com/upload/">java applet</a>-based drag and drop solutions, but
they are reserved for developers who have nothing but disdain for their users.</p>
    </div>
    <div class='subfooter'>
      <div class='tombstone'>▪</div>
      <time class='published'>February 15, 2009</time>
    </div>
  </article>
</section>


<footer>
  <div>
    © Copyright 2005–2023 Boris Smus.
  </div>
  <nav role="footer">
    <a href='https://smus.com/atom.xml'>RSS</a>
  </nav>
</footer>

<!-- Misc scripts: syntax highlighting, analytics, stats. -->
<script src="/static/js/highlight.pack.js"></script>
<!-- Syntax highlighting for code. -->
<script>
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
</script>
<!-- Lightning builder error check. -->
<script src="/lightning_error.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-38Y45XD5VQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-38Y45XD5VQ');
</script>


</body>
</html>